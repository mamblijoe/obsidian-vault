
В этой главе обсуждается исторически противоречивая проблема — повышение производительности кода. В 1960#х годах ресурсы компьютеров были крайне ограниченны, поэтому эффективность их использования была вопросом первостепенной важности. По мере роста производительности компьютеров в 70#х программисты начали понимать, насколько упор на производительность вредит удобочитаемости и легкости сопровождения кода, и оптимизация кода отошла на задний план. Вместе с микрокомпьютерной революцией, свидетелями которой мы стали в 80#х, проблема эффективного использования ресурсов вернулась, но в 90#х ее важность постепенно уменьшилась. В 2000#х мы опять столкнулись с этой проблемой, только теперь она связана с ограниченной памятью мобильных телефонов, карманных ПК и подобных устройств, а также со временем выполнения интерпретируемого кода.

Проблемы с производительностью можно решать на двух уровнях: стратегическом и тактическом. В этой главе рассматриваются стратегические вопросы производительности: мы выясним, что такое производительность, насколько она важна, и обсудим общий подход к ее повышению. Если стратегии достижения нужной производительности вам уже хорошо известны и вы хотите узнать конкретные методики ее повышения на уровне кода, можете перейти к главе 26. Однако прежде чем приступать к серьезной работе над повышением производительности, хотя бы просмотрите эту главу, чтобы не потратить время на оптимизацию кода тогда, когда следовало бы заняться чем#то другим.
## Производительность и оптимизация кода

Оптимизация кода — лишь один из способов повышения производительности программы. Часто можно найти другие способы, обеспечивающие большее повышение производительности за меньшее время и с меньшим вредом для кода.

>[!info] Требования к программе
>Зачастую пользователей может устроить и меньшая производительность, что снизит траты

>[!info] Проект программы
>На этапе проектирование можно рассмотреть альтернативные варианты которые будут производительнее изначально
>Плюсы:
>* Возможность задавать отдельные целевые показатели производительности для отдельных частей системы
>* Просто задание явных целей производительности повышает вероятность их достижения
>* Можно поставить цели которые прямо не повышают производительность, но в перспективе улучшат ее

>[!info] Проекты классов и методов
>Выбор правильных типов данных или алгоритмов

>[!info] Взаимодействие программы с ОС

>[!info] Компиляция кода

>[!info] Оборудование 
>Покупка более мощного железа

>[!info] Оптимизация кода

> Менее 4% кода обычно соответствует более чем 50% времени выполнения программы
> \- Дональд Кнут

## Мифы оптимизации

>[!danger]  Сокращение числа строк высокоуровневого кода повышает быстродействие

>[!danger] Одни операции, вероятно, выполняются быстрее других
>Только точное измерение показателей, никаких "вероятно"

>[!danger] Оптимизацию следует выполнять по мере написания кода

>[!danger] Быстродействие программы не менее важно чем ее корректность

## Алгоритм оптимизации

1) Напишите хороший и понятный код, поддающийся легкому изменению
2) Если производительность не устраивает
	1) Закоммитьте рабочий код
	2) Оцените производительность системы и найдите горячие точки
	3) Определите чем обусловлена низкая производительность
	4) Оптимизируйте проблемное место
	5) Оцените каждую оптимизацию по одной за раз
	6) Если оптимизация не привела к улучшению, повторите все заново	 

>[!tip] Ключевые моменты
>* Производительность — всего лишь один из аспектов общего качества ПО, и, как правило, не самый важный. Оптимизация кода — лишь один из способов повышения производительности ПО, и тоже обычно не самый важный. Быстродействие программы и ее объем обычно в большей степени зависят не от эффективности кода, а от архитектуры программы, детального проектирования выбора структур данных и алгоритмов.
>* Важнейшее условие максимизации быстродействия кода — его количественная оценка. Она необходима для обнаружения  областей, производительность которых действительно нуждается в повышении, а также для проверки того, что в результате  оптимизации производительность повысилась, а не понизилась.
>* Как правило, основная часть времени выполнения программы приходится на небольшую часть кода. Не выполнив оценку, вы не  найдете этот код.
>* Достижение желаемого повышения производительности кода при помощи его оптимизации обычно требует нескольких итераций.
>* Во время первоначального кодирования нет лучше способа подготовки к повышению производительности программы, чем  написание ясного и понятного кода, поддающегося легкому изменению.

